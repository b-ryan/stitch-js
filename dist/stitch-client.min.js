!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Stitch=e()}}(function(){return function e(t,i,n){function o(r,l){if(!i[r]){if(!t[r]){var u="function"==typeof require&&require;if(!l&&u)return u(r,!0);if(s)return s(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var a=i[r]={exports:{}};t[r][0].call(a.exports,function(e){var i=t[r][1][e];return o(i||e)},a,a.exports,e,t,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({1:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=function(e){return e&&e.__esModule?e:{default:e}}(e("./EVENT_TYPES.js")),r=function(){},l=new Set(Object.values(s.default)),u=function(){function e(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this._childWindow=null,this._initialized=!1,this._context=i,this._subscribers=[],window.addEventListener("message",function(e){e.source===t._childWindow&&t._onMessage(e.data)})}return o(e,[{key:"subscribe",value:function(e){var t=this,i=function(){t._subscribers=t._subscribers.filter(function(t){return e!==e})};return this._subscribers.push(e),i}},{key:"_emit",value:function(e){var t=!0,i=!1,n=void 0;try{for(var o,s=this._subscribers[Symbol.iterator]();!(t=(o=s.next()).done);t=!0)(0,o.value)(e)}catch(e){i=!0,n=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw n}}}},{key:"_pollForChildWindowClosed",value:function(){var e=this;window.setTimeout(function(){e._childWindow&&(e._childWindow.closed?e._windowClosed():e._pollForChildWindowClosed())},1e3)}},{key:"_windowClosed",value:function(){r("event: closed"),this._childWindow=null,this._initialized=!1,this._emit({type:"closed"})}},{key:"_onMessage",value:function(e){e.type===s.default.BOOTSTRAP?(r("event: initialized"),this._initialized=!0,this._sendContext()):"closed"===e.type?this._windowClosed():l.has(e.type)?(r("event",e),this._emit(e)):r("event: [WARNING] unknown message type",e)}},{key:"_sendContext",value:function(){if(!this._initialized||this._childWindow.closed)return this.initialize();r("send context",this._context),this._childWindow.postMessage({type:"update",data:this._context},"*")}},{key:"setContext",value:function(e){this._content=e,this._sendContext()}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r("initialize"),this._context=e,this._childWindow&&this._childWindow.close(),this._initialized=!1,this._childWindow=window.open("https://app.stitchdata.com/v2/js-client"),this._pollForChildWindowClosed()}},{key:"close",value:function(){r("close"),this._childWindow&&this._childWindow.close()}}]),e}();i.default=u},{"./EVENT_TYPES.js":2}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=Object.freeze({BOOTSTRAP:"bootstrap",CLOSED:"closed",CONNECTION_CREATED:"connectionCreated",CONNECTION_UPDATED:"connectionUpdated",INTEGRATION_FORM_CLOSE:"integrationFormClose"})},{}],3:[function(e,t,i){"use strict";var n=e("./Client.js"),o=e("./utils.js");t.exports={Client:n,addSourceIntegration:o.addSourceIntegration}},{"./Client.js":1,"./utils.js":4}],4:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var i=new s.default,n=!1,o=void 0;i.subscribe(function(s){s.type===r.default.CONNECTION_CREATED&&s.data.type===e?o=s.data:s.type!==r.default.CLOSED&&s.type!==r.default.INTEGRATION_FORM_CLOSE||(i.close(),n||(t(o),n=!0))}),i.initialize({hideNav:!0,preventIntegrationFormClose:!0,targetState:{name:"app.connections.create",params:{route:e}}})}Object.defineProperty(i,"__esModule",{value:!0}),i.addSourceIntegration=o;var s=n(e("./Client.js")),r=n(e("./EVENT_TYPES.js"))},{"./Client.js":1,"./EVENT_TYPES.js":2}]},{},[3])(3)});